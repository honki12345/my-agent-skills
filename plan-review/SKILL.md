---
name: plan-review
description: "구현 계획 문서를 4가지 관점에서 병렬 리뷰 (문서 정합성, 웹 검증, 코드 실현 가능성, 계획 품질)"
argument-hint: "[plan-file-path]"
disable-model-invocation: true
---

# Plan Review

구현 계획 문서를 4가지 관점에서 **병렬로** 리뷰합니다.

## 사용법

- `/plan-review path/to/plan.md` — 지정한 계획 문서를 4가지 관점에서 리뷰
- `/plan-review` — 인자 없이 호출하면 파일 경로를 요청

## 실행 워크플로우

### 1단계: 계획 문서 읽기

`$ARGUMENTS`에서 파일 경로를 추출한다.

- 인자가 없으면: "리뷰할 계획 문서의 경로를 입력해주세요. 예: `/plan-review docs/plan/feature.md`" 라고 안내하고 **중단**한다.
- 인자가 있으면: `Read` 도구로 해당 파일을 읽는다. 파일이 존재하지 않으면 에러를 안내하고 중단한다.

### 2단계: 4개 Task 동시 실행

> **핵심**: 반드시 **하나의 메시지**에서 4개의 `Task` 도구 호출을 동시에 보내야 한다.

읽어온 계획 문서 전문을 각 Task의 프롬프트에 포함시켜 4개를 **병렬**로 실행한다.

---

#### Task 1: 문서 정합성 (subagent_type: Explore)

**description**: "문서 정합성 체크"

**prompt**:

```
아래 구현 계획 문서를 프로젝트의 기존 문서와 비교하여 정합성을 검토하라.

## 계획 문서
{계획 문서 전문}

## 검토 절차

1. 프로젝트 루트에서 다음 파일/디렉토리를 탐색한다:
   - CLAUDE.md, AGENTS.md (프로젝트 루트 및 .claude/)
   - docs/ 디렉토리
   - plans/ 디렉토리
   - README.md
   - 기타 컨벤션 문서 (.github/, CONTRIBUTING.md 등)

2. 각 문서에 대해 다음을 확인한다:
   - 계획이 기존 컨벤션/규칙과 **충돌**하는 부분
   - 계획이 기존 문서에서 정의한 것을 **누락**한 부분
   - 계획이 참조하는 문서/경로가 실제로 **존재**하는지

3. 발견 사항이 없으면 "충돌/누락 없음"이라고 명시한다.

## 출력 형식

발견 사항을 아래 형식으로 출력하라. 발견이 없으면 해당 카테고리를 생략한다.

[CONFLICT] {설명} — {근거 파일:라인}
[GAP] {설명} — {참조 문서}
[NOTE] {설명}

마지막에 한 줄 요약을 추가하라.
```

---

#### Task 2: 웹 검증 (subagent_type: general-purpose)

**description**: "기술 주장 웹 검증"

**prompt**:

```
아래 구현 계획 문서에서 기술적 주장을 추출하고 웹 검색으로 검증하라.

## 계획 문서
{계획 문서 전문}

## 검토 절차

1. 계획에서 다음과 같은 기술적 주장을 모두 추출한다:
   - 특정 라이브러리/프레임워크의 기능, 버전, API
   - 특정 기술의 제한사항 또는 성능 특성
   - 외부 서비스/API의 동작 방식
   - 아키텍처 패턴이나 베스트 프랙티스에 대한 주장

2. 각 주장에 대해 WebSearch를 사용하여 검증한다:
   - 공식 문서, GitHub 이슈, Stack Overflow 등을 참조
   - 현재 최신 버전 기준으로 확인

3. 기술적 주장이 없는 경우 "검증 대상 없음"이라고 명시한다.

## 출력 형식

| # | 주장 | 판정 | 근거 |
|---|------|------|------|
| 1 | {주장 요약} | VERIFIED / OUTDATED / INCORRECT / UNVERIFIED | {출처 또는 설명} |

- VERIFIED: 현재 기준 정확함
- OUTDATED: 이전에는 맞았으나 현재 변경됨
- INCORRECT: 사실과 다름
- UNVERIFIED: 검증 불가 (출처 없음)

마지막에 한 줄 요약을 추가하라.
```

---

#### Task 3: 코드 실현 가능성 (subagent_type: Explore)

**description**: "코드 실현 가능성 분석"

**prompt**:

```
아래 구현 계획 문서를 현재 프로젝트 코드베이스와 대조하여 실현 가능성을 평가하라.

## 계획 문서
{계획 문서 전문}

## 검토 절차

1. Glob과 Grep으로 프로젝트 구조를 파악한다:
   - 주요 디렉토리 구조
   - 사용 중인 언어, 프레임워크, 패키지
   - 설정 파일 (package.json, tsconfig.json, pyproject.toml 등)

2. 계획에서 언급하는 파일/모듈/패턴을 프로젝트에서 찾는다:
   - 수정 대상 파일이 실제로 존재하는가?
   - 계획이 가정하는 구조가 실제와 일치하는가?
   - 의존성이 이미 설치되어 있는가, 추가 설치가 필요한가?

3. 변경의 영향 범위를 평가한다:
   - 수정 대상 파일을 참조하는 다른 파일은 무엇인가?
   - 계획에서 고려하지 않은 사이드이펙트가 있는가?

## 출력 형식

**실현 가능성**: HIGH / MEDIUM / LOW

**근거**:
- {항목 1}: {설명}
- {항목 2}: {설명}

**영향받는 파일** (계획에 명시되지 않은 것):
- {파일 경로}: {영향 설명}

**누락된 의존성/설정**:
- {항목}: {설명}

마지막에 한 줄 요약을 추가하라.
```

---

#### Task 4: 계획 품질 (subagent_type: general-purpose)

**description**: "계획 품질 평가"

**prompt**:

```
아래 구현 계획 문서의 품질을 7가지 차원에서 평가하라.

## 계획 문서
{계획 문서 전문}

## 평가 차원

각 차원을 1~5점으로 평가하고 근거를 제시하라.

1. **목표 명확성**: 계획이 달성하려는 것이 명확한가?
   - 5: 구체적이고 측정 가능한 목표
   - 3: 대략적인 방향은 있으나 모호한 부분 존재
   - 1: 무엇을 달성하려는지 불분명

2. **접근법 타당성**: 선택한 기술적 접근이 적절한가?
   - 5: 최적의 접근, 대안 대비 명확한 이점
   - 3: 합리적이나 더 나은 대안 가능
   - 1: 부적절하거나 비효율적인 접근

3. **엣지케이스 고려**: 예외 상황을 충분히 다루는가?
   - 5: 주요 엣지케이스 모두 식별 및 대응 방안 제시
   - 3: 일부 엣지케이스만 고려
   - 1: 엣지케이스 미고려

4. **리스크 식별**: 잠재적 위험을 인지하고 있는가?
   - 5: 리스크 식별 + 완화 전략 제시
   - 3: 일부 리스크만 언급
   - 1: 리스크 미고려

5. **범위 적절성**: 작업 범위가 적절한가?
   - 5: 필요한 것만 포함, 과다/과소 없음
   - 3: 약간의 범위 초과 또는 부족
   - 1: 범위가 지나치게 크거나 핵심 누락

6. **의존성 파악**: 외부/내부 의존성이 정리되어 있는가?
   - 5: 모든 의존성 명시, 순서/조건 정리
   - 3: 주요 의존성만 언급
   - 1: 의존성 미파악

7. **완전성**: 계획대로 실행하면 목표 달성이 가능한가?
   - 5: 바로 실행 가능한 수준
   - 3: 추가 정보 필요하나 대부분 커버
   - 1: 핵심 단계 누락

## 출력 형식

| 차원 | 점수 | 평가 |
|------|------|------|
| 목표 명확성 | {1-5} | {한 줄 평가} |
| 접근법 타당성 | {1-5} | {한 줄 평가} |
| 엣지케이스 고려 | {1-5} | {한 줄 평가} |
| 리스크 식별 | {1-5} | {한 줄 평가} |
| 범위 적절성 | {1-5} | {한 줄 평가} |
| 의존성 파악 | {1-5} | {한 줄 평가} |
| 완전성 | {1-5} | {한 줄 평가} |

**종합 점수**: {평균}/5

마지막에 한 줄 요약을 추가하라.
```

---

### 3단계: 통합 리포트 출력

4개 Task의 결과를 아래 템플릿으로 통합하여 출력한다.

```markdown
# Plan Review Report

**문서**: {파일 경로}
**일시**: {현재 날짜/시간}

## Overall Verdict: {PASS / CONCERNS / FAIL}

판정 기준:
- **PASS**: 4개 체크 모두 심각한 이슈 없음
- **CONCERNS**: 일부 주의 필요 사항 발견 (CONFLICT, OUTDATED, LOW feasibility, 평균 3점 미만 차원 존재)
- **FAIL**: 심각한 문제 발견 (INCORRECT 주장, 실현 불가, 핵심 충돌)

---

## 1. 문서 정합성

{Task 1 결과}

## 2. 웹 검증

{Task 2 결과}

## 3. 코드 실현 가능성

{Task 3 결과}

## 4. 계획 품질

{Task 4 결과}

---

## Recommendations

우선순위 높은 순서대로:

1. [CRITICAL/HIGH/MEDIUM/LOW] {권고사항}
2. ...
```

판정 및 Recommendations는 4개 결과를 종합하여 Claude가 직접 작성한다.
